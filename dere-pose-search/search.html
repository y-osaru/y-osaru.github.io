<!DOCTYPE html>
<html lang="js">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-141192565-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-141192565-1');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta description="アイドルマスターシンデレラガールズスターライトステージ(デレステ)のフォトスタジオに追加されている○○ちゃんっぽく！！の一覧と検索が出来るサイト">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>デレステフォトスタジオ-ポーズ検索</title>
    <link href="lightbox/lightbox.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" 
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.8/vue.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="js/hammer.min.js"></script>
    <script src="js/jquery.hammer.js"></script>
    <link rel="stylesheet" href="css/style.css?20190618" >
    <link rel="manifest" href="manifest.json?20190831">
    <link rel="apple-touch-icon" href="ico/ico-144.png" sizes="144x144">
    <link rel="apple-touch-icon" href="ico/ico-152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="ico/ico-180.png" sizes="180x180">
    <link rel="apple-touch-icon" href="ico/ico-192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="ico/ico-256.png" sizes="256x256">
    <link rel="apple-touch-icon" href="ico/ico-512.png" sizes="512x512">
</head>
<body>
<script>
    if('serviceWorker' in navigator) {
       navigator.serviceWorker.register('sw.js').then(function(registration) {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }).catch(function(err) {
            console.log('ServiceWorker registration failed: ', err);
        });
    }
</script>
<div class="jumbotron">
    <div class="container">
        <h1 >デレステ <br>フォトスタジオ<br>ポーズ検索</h1>
        <p>デレステのフォトスタジオの「○○ちゃんっぽく」を簡単に検索できるサイト</p>
        <small class="text-muted">※本サイト及びアプリケーションは非公式のものであり、株式会社ディー・エヌ・エー/株式会社Cygames/株式会社バンダイナムコホールディングス/その他公式関連各社とは一切無関係に運営されています。<br/>
        お問い合わせ等ございましたら、サイト下部に記載されておりますtwitterよりお願い致します。</small>
        <small class="text-muted" style="position:absolute;right:10px;top:0;">更新日：<span id="update_on"><span></small>
    </div>
</div>
<div class="container">
<div id="pose-list">
    <div class="col-md-12 col-12">
        <div class="form-group">
            <input type="text" class="form-control search" placeholder="検索"/>
        </div>
        <div class="form-group form-inline">
            <button class="type-btn btn page-link text-dark d-inline-block" value="All">
                <img src="https://storage.googleapis.com/mobampmaster_stamp_contents/all_logo.png" width="25" height="25">
                <span>全て</span>
            </button>
            <button class="type-btn btn page-link text-dark d-inline-block" value="Cu">
                <img src="https://storage.googleapis.com/mobampmaster_stamp_contents/CfhyOYdUYAERQxa.png" width="25" height="25">
                <span>キュート</span>
            </button>
            <button class="type-btn btn page-link text-dark d-inline-block" value="Co">
                <img src="https://storage.googleapis.com/mobampmaster_stamp_contents/CfhyOYcUEAEeih7.png" width="25" height="25">
                <span>クール</span>
            </button>
            <button class="type-btn btn page-link text-dark d-inline-block" value="Pa">
                <img src="https://storage.googleapis.com/mobampmaster_stamp_contents/CfhyOZYUEAIPzqo.png" width="25" height="25">
                <span>パッション</span>
            </button>
            <button class="sort btn page-link text-dark d-inline-block" data-sort="name_ja">
                <i class="fas fa-arrows-alt-v"></i>
                <span>名前で並び替え</span>
            </button>
            <button class="sort btn page-link text-dark d-inline-block" data-sort="id">
                <i class="fas fa-undo"></i>
                <span>並び替えリセット</span>
            </button>
        </div>
    </div>   
    <div id="pose-area" class="col-md-12 col-12">
        <div v-show="loading" class="loader">Now loading...</div>
        <div v-show="!loading">
            <ul  class="list-inline list">
                <li class="list-inline-item" v-for="pose in items">
                    <a v-bind:href="pose.url" data-lightbox="pose-view" v-bind:data-title="pose.name">
                        <img v-bind:src="pose.url">
                        <p class="id" style="display:none;">{{ pose.id }}</p>
                        <p class="name" style="display:none;">{{ pose.name }}</p>
                        <p class="name_ja" style="display:none;">{{ pose.name_ja }}</p>
                        <p class="type" style="display:none;">{{ pose.type }}</p>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>
</div>
<footer id="footer">
    <div class="container">
        <p class="text-muted"><a href="https://twitter.com/SARU_KABUTO" target="_top">製作者:SARU</a></p>
    </div>
</footer>
<script>
new Vue({
    el:"#pose-area",
    data:{
        items:[],
        update: "",
        loading:true
    },
    created(){
        let self = this;
        axios.get("https://script.google.com/macros/s/AKfycbyUYxGXh4Pu_6RiIAY1gjCBFB3NOTGJzR64NeSVqY6FQbINXoxJ/exec")
        .then(res => {
            self.items = res.data.poses;
            self.update = res.data.update;
            self.loading = false;
        }).then(() => {
            const options = {
                valueNames:["id","name","name_ja","type"]
            }
            let poseList = new List("pose-list",options);

            $(".type-btn").click(function(){
                let typeValue = this.value;
                poseList.filter(function(item){
                    if(item.values().type === typeValue || typeValue === 'All'){
                        return true;
                    }else{
                        return false;
                    }
                })
            });
            
            $("#update_on").text(self.update);

            $('#lightbox').hammer().on("swipe", function (e) {
                if (e.gesture.direction === 4) {
                    //表示されてなくても戻れちゃうのでstyle="display:none"で判定する。
                    let prev = $("#lightbox a.lb-prev");
                    if(prev.css("display") !== "none"){
                        prev.trigger("click");
                    }
                } else if (e.gesture.direction === 2) {
                    let next = $("#lightbox a.lb-next");
                    if(next.css("display") !== "none"){
                        next.trigger("click");
                    }
                }
            });
        });
    }
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" ></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" ></script>
<script src="lightbox/lightbox.min.js"></script>
</body>
</html>